//
//  OpenOperatorListView+ViewConverter.swift
//  SendbirdSwiftUI
//
//  Copyright Â© 2024 Sendbird, Inc. All rights reserved.
//

import SwiftUI
import SendbirdChatSDK

extension SBUUserListModule.List {
    typealias ViewConverterForOpenOperators = OpenOperatorListViewConverter.List
    
    var viewConverterForOpenOperators: ViewConverterForOpenOperators {
        SBViewConverterSet.OpenOperatorList.list
    }
}

extension SBUUserListModule.List {
    func applyViewConverterForOpenOperators(_ viewType: ViewConverterForOpenOperators.ViewType) -> Bool {
        let tag = viewType.tag
        
        switch viewType {
        case .entireContent:
            let users = self.userList
            if let tableViewConverter = self.viewConverterForOpenOperators.tableView.entireContent,
               let hostingView = tableViewConverter(
                .init(
                    parentView: self,
                    users: users
                )
               ) {
            
                // remove UITableView
                self.tableView.removeFromSuperview()
                
                // add hostingView as subview of List
                hostingView.tag = tag
                self.addSubview(hostingView)
                
                hostingView
                    .sbu_constraint_fill(equalTo: self)
                    .sbu_constraint(height: self.frame.height)
                
                return true
            }
            return false
        }
    }
}
